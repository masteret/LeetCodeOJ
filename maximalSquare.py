__author__ = 'ET'
import math
import timeit
import sys

class Solution:
    # @param {character[][]} matrix
    # @return {integer}
    def maximalSquare(self, matrix):
        result = 0
        for row_index, row in enumerate(matrix):
            for index, item in enumerate(row):
                if item == "1":
                    right_count = 0
                    for x in xrange(index, len(row)):
                        if row[x] == "1":
                            right_count += 1
                        else:
                            break

                    if right_count > result:
                        bottom_count = 0
                        bottom_right_count = 0
                        min_bottom_right_count = sys.maxint
                        for x in xrange(row_index, min(row_index + right_count, len(matrix))):
                            bottom_count += 1
                            bottom_right_count = 0
                            for i in xrange(index, min(len(row), index + right_count)):
                                if matrix[x][i] == "1":
                                    bottom_right_count += 1
                                else:
                                    break

                            min_bottom_right_count = min(min_bottom_right_count, bottom_right_count)
                            if min_bottom_right_count <= bottom_count:
                                break
                        result = max(result, min([bottom_count, min_bottom_right_count, right_count]))
                        # print [result], row_index, index, bottom_count, min_bottom_right_count, right_count
        # Check the min of bottom, right and bottom right

        return int(math.pow(result,2))


if __name__ == "__main__":
    puppy = Solution()
    # 4 1 1 4 9 16 9 4 64
    print puppy.maximalSquare(["10100","10111","11111","10010"])
    print puppy.maximalSquare(["1"])
    print puppy.maximalSquare(["10"])
    print puppy.maximalSquare(["1010","1011","1011","1111"])
    print puppy.maximalSquare(["0001","1101","1111","0111","0111"])
    print puppy.maximalSquare(["11111111","11111110","11111110","11111000","01111000"])
    print puppy.maximalSquare(["0010","1111","1111","1110","1100","1111","1110"])
    print puppy.maximalSquare(["010010000110011","000001101001001","000000100100000","000010111110011","010100110000011","000110111000111","111000101000100","010100111100001","010001011010011","000110010100010","111010011101000","000110110110110","001101010101100"])

    timed = False
    timed = True
    if timed:
        start = timeit.default_timer()
        print puppy.maximalSquare(["1111111111111101001111111100111011111111","1111011011111111101101111101111111111111","0111101011111101101101101111111111111111","0101101011111111111101111111010110111111","1111111111110111110110010111111111111111","1111111110110101111111111101011111101111","0110110101110011111111111111110111110101","0111111111111100111111100110011011010101","1111011110111111111011011011110101101011","1111111110111111111101101101110111101111","1110110011111111111100111111111111111111","1011111110111101111001110111111111111111","0110111111111111101111110111011111011111","1111111111111111011111111111110111111011","1111100111111110101100111111111111101111","1111101111111110111111011111111111011111","1111101111111111111111011001111110011111","1111110111111111011111111111110111110111","1011111111111111010111110010111110111111","1111110011111111111110111111111111111011","1111111111111111110111011111011111011011","1100011011111111111111011111011111111111","1111101011111111111101100101110011111111","1110010111111111111011011110111101111101","1111111111111101101111111111101111111111","1111111011111101111011111111111110111111","1110011111111110111011111111110111110111","1111111111111100111111010111111111110111","1111111111111111111111000111111111011101","1111110111111111111111111101100111011011","1111011011111101101101111110111111101111","1111111111011111111111111111111111111111","1111111111111111111111111111111111111111","1100011111111110111111111111101111111011","1111101111111101111010111111111111111111","0111111111110011111111110101011011111111","1011011111101111111111101111111111110011","1010111111111111111111111111111110011111","0111101111011111111111111111110111111111","0111111011111111011101111011101111111111","0111111111110101111011111101011001111011","1111111111111011110111111101111111101110","1111101111111100111111111110111111001111","1101101111110101111101111111100111010100","0110111111100111110010111110111011011101"])
        print timeit.default_timer() - start